{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}

<section class="relative">
  <!-- soft background glows -->
  <div class="pointer-events-none absolute inset-0 -z-10 blur-3xl opacity-40"
       style="background:
         radial-gradient(60% 50% at 20% 10%, rgba(99,102,241,.14), transparent 60%),
         radial-gradient(60% 50% at 80% 30%, rgba(236,72,153,.14), transparent 60%),
         radial-gradient(50% 40% at 50% 90%, rgba(34,197,94,.14), transparent 60%);"></div>

  <!-- Header -->
  <div class="mb-4 sm:mb-6 flex items-start justify-between gap-3">
    <div class="min-w-0">
      <h1 class="text-xl sm:text-2xl font-bold text-gray-900 truncate">
        {{ ticket.subject }}
      </h1>
      <div class="mt-1 flex flex-wrap items-center gap-2 text-sm text-gray-600">
        <span class="font-mono text-gray-500">#{{ ticket.id }}</span>
        <span class="text-gray-300">•</span>
        <span>{% trans "Opened" %} {{ ticket.created_at|date:"M d, Y H:i" }}</span>
        {% if ticket.updated_at %}
          <span class="text-gray-300">•</span>
          <span>{% trans "Updated" %} {{ ticket.updated_at|date:"M d, Y H:i" }}</span>
        {% endif %}
      </div>
    </div>

    <!-- Status badge -->
    {% with s=ticket.status|lower %}
    <span
      class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-xs font-semibold
      {% if s == 'open' %} bg-emerald-100 text-emerald-700
      {% elif s == 'pending' %} bg-amber-100 text-amber-700
      {% elif s == 'closed' %} bg-gray-200 text-gray-700
      {% else %} bg-gray-100 text-gray-700 {% endif %}">
      <i class="fas
        {% if s == 'open' %} fa-life-ring
        {% elif s == 'pending' %} fa-hourglass-half
        {% elif s == 'closed' %} fa-circle
        {% else %} fa-info-circle {% endif %}"></i>
      {{ ticket.status|title }}
    </span>
    {% endwith %}
  </div>

  <!-- Layout -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-5">
    <!-- Left: Message -->
    <section class="lg:col-span-2 rounded-2xl border border-gray-200 bg-white/90 shadow-sm overflow-hidden">
      <div class="px-4 sm:px-5 py-3 border-b bg-gradient-to-r from-indigo-50/80 to-blue-50/40 backdrop-blur">
        <div class="flex items-center gap-2 text-sm text-gray-700">
          <i class="fas fa-envelope-open text-indigo-500"></i>
          <span class="font-semibold">{% trans "Original message" %}</span>
        </div>
      </div>

      <article class="p-4 sm:p-5">
        <div class="prose prose-sm max-w-none text-gray-800">
          {{ ticket.message|linebreaksbr }}
        </div>
      </article>
    </section>

    <!-- Right: Properties -->
    <aside class="rounded-2xl border border-gray-200 bg-white/90 shadow-sm p-4 sm:p-5 space-y-4">
      <h3 class="text-sm font-semibold text-gray-900 flex items-center gap-2">
        <i class="fas fa-sliders-h text-indigo-500"></i> {% trans "Ticket details" %}
      </h3>

      <dl class="grid grid-cols-1 gap-3 text-sm">
        <div class="grid grid-cols-3 gap-2 items-center">
          <dt class="text-gray-500">{% trans "Status" %}</dt>
          <dd class="col-span-2 text-gray-800">{{ ticket.status|title }}</dd>
        </div>

        <div class="grid grid-cols-3 gap-2 items-center">
          <dt class="text-gray-500">{% trans "Priority" %}</dt>
          <dd class="col-span-2 text-gray-800">{{ ticket.priority|title }}</dd>
        </div>

        <div class="grid grid-cols-3 gap-2 items-center">
          <dt class="text-gray-500">{% trans "Category" %}</dt>
          <dd class="col-span-2 text-gray-800">
            {% if ticket.category == 'technical' %}{% trans "Technical" %}
            {% elif ticket.category == 'billing' %}{% trans "Billing" %}
            {% elif ticket.category == 'account' %}{% trans "Account" %}
            {% else %}{% trans "Other" %}{% endif %}
          </dd>
        </div>

        <div class="grid grid-cols-3 gap-2 items-center">
          <dt class="text-gray-500">{% trans "Created" %}</dt>
          <dd class="col-span-2 text-gray-800">{{ ticket.created_at|date:"M d, Y H:i" }}</dd>
        </div>

        {% if ticket.updated_at %}
        <div class="grid grid-cols-3 gap-2 items-center">
          <dt class="text-gray-500">{% trans "Last update" %}</dt>
          <dd class="col-span-2 text-gray-800">{{ ticket.updated_at|date:"M d, Y H:i" }}</dd>
        </div>
        {% endif %}
      </dl>

      <div class="pt-3">
        <button type="button"
                onclick="history.back()"
                class="w-full inline-flex items-center justify-center gap-2 px-3 py-2 rounded-lg border bg-white text-sm hover:bg-gray-50">
          <i class="fas fa-arrow-left"></i> {% trans "Back" %}
        </button>
      </div>
    </aside>
  </div>
</section>
